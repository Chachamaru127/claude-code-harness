# /plan - 機能計画の作成

ユーザーの要望を構造化されたタスクリストに変換します。
VibeCoder が「〇〇を作りたい」と言うだけで、実行可能な計画が生成されます。

---

## ⚠️ モード別の使い分け

| モード | 推奨コマンド | 説明 |
|--------|-------------|------|
| **ソロモード** | `/plan` (このコマンド) | Claude Code だけで計画→実行→レビュー |
| **2エージェントモード** | `/plan-with-cc` (Cursor側) | Cursor で計画 → Claude Code で実行 |

**2エージェント体制** (`/setup-2agent` 済み) の場合:
- **Cursor** で `/plan-with-cc` を使って計画を立ててください
- そのまま Claude Code で `/plan` を使うこともできますが、Cursor との連携は行われません

---

## このコマンドの目的

**compound engineering** の原則: 各作業が次の作業を簡単にする

> 「ブログを作りたい」→ 実行可能なタスクリストへ変換

---

## 実行フロー

### Step 1: 要望のヒアリング

ユーザーの入力を確認。入力がない場合は質問：

> 🎯 **何を作りたいですか？**
>
> 例：
> - 「ブログサイト」
> - 「タスク管理アプリ」
> - 「ECサイト」
> - 「ポートフォリオ」
>
> ざっくりで大丈夫です！

**回答を待つ**

### Step 2: 解像度を上げる（最大2問）

> 📋 **もう少し教えてください：**
>
> 1. 誰が使いますか？（自分 / チーム / 一般公開）
> 2. 似ているサービスはありますか？（例: Notion, Zenn, メルカリ）

**回答を待つ**

### Step 3: 技術調査（WebSearch）

**ユーザーには聞かない。Claude Code が調査して提案。**

```
WebSearch で調査:
- "{{プロジェクトタイプ}} tech stack 2025"
- "{{類似サービス}} architecture"
- "{{プロジェクトタイプ}} best practices beginner friendly"
```

### Step 4: 計画の生成

以下の形式で Plans.md を更新：

```markdown
## 🎯 プロジェクト: {{プロジェクト名}}

### 概要
- **目的**: {{ユーザーのやりたいこと}}
- **対象**: {{誰が使うか}}
- **参考**: {{類似サービス}}

### 技術スタック（提案）
- フロントエンド: {{推奨技術}}
- バックエンド: {{推奨技術}}
- データベース: {{推奨技術}}
- デプロイ: {{推奨サービス}}

---

## 🔴 フェーズ1: 基盤構築 `cc:TODO`

- [ ] プロジェクト初期化（create-next-app等）
- [ ] 基本ディレクトリ構造の作成
- [ ] 開発環境のセットアップ（ESLint, Prettier）
- [ ] Git初期化 & 初回コミット

## 🟡 フェーズ2: コア機能 `cc:TODO`

- [ ] {{コア機能1}}
- [ ] {{コア機能2}}
- [ ] {{コア機能3}}

## 🟢 フェーズ3: 仕上げ `cc:TODO`

- [ ] UIの調整
- [ ] テストの追加
- [ ] デプロイ設定
```

### Step 5: 次のアクションを案内

> ✅ **計画が完成しました！**
>
> 📄 `Plans.md` に {{タスク数}} 個のタスクを追加しました。
>
> **次にやること：**
> 「フェーズ1を始めて」または「プロジェクトを作って」と言ってください。
>
> 💡 **ヒント**: いつでも「次は何をすればいい？」と聞いてください。

---

## 出力例

ユーザー: 「ブログを作りたい」

→ 生成される計画:

```markdown
## 🎯 プロジェクト: my-blog

### 概要
- **目的**: 技術記事を書いて公開するブログ
- **対象**: 一般公開
- **参考**: Zenn, Qiita

### 技術スタック（提案）
- フロントエンド: Next.js 14 + Tailwind CSS
- バックエンド: Next.js API Routes
- データベース: Supabase (PostgreSQL)
- デプロイ: Vercel

---

## 🔴 フェーズ1: 基盤構築

- [ ] `npx create-next-app@latest my-blog` を実行
- [ ] Tailwind CSS のセットアップ
- [ ] Supabase プロジェクト作成
- [ ] 環境変数の設定

## 🟡 フェーズ2: コア機能

- [ ] 記事一覧ページの作成
- [ ] 記事詳細ページの作成
- [ ] Markdown レンダリング
- [ ] 記事データのDB連携

## 🟢 フェーズ3: 仕上げ

- [ ] OGP設定
- [ ] SEO対策
- [ ] Vercelへのデプロイ
```

---

## 注意事項

- **技術選択はユーザーに聞かない**: VibeCoder は詳しくない前提
- **フェーズ分けを明確に**: 達成感を感じやすくする
- **具体的なコマンドを含める**: `npx create-next-app` など
- **Plans.md を必ず更新**: 計画を永続化
